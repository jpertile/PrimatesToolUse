---
title: "Visualizations"
format: pdf
editor: visual
---

```{r}
#load packages
library(tidyverse)
library(tidymodels)
library(knitr)
library(ape)
library(caper)
library(phytools)
library(nlme)
library(gee)
library(TreeTools)
library(patchwork)
library(phylolm)
library(broom)
library(readxl)

#load data and phylogenetic tree
tool_use_expanded <- read_xlsx("PrimateToolUseDataset.xlsx", sheet = "Dataset")
tooluse.tree <- read.nexus("ToolUsePhylo54.nex")
```

```{r, message = FALSE, warning = FALSE}
#EDA

set.seed(13)

ggplot(tool_use_expanded, aes(x = Omnivore, y = Tool_Use)) +
  geom_jitter(width = 0.15, height = 0.15, 
              aes(color = Taxon), size = 3, alpha = 0.5) + 
  geom_smooth(method = glm, se = F, method.args = list(family="binomial")) + 
  labs(title = "Omnivory vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Omnivory (1 = Yes, 0 = No") + 
  theme_minimal() 

ggplot(tool_use_expanded, aes(x = Frugivore, y = Tool_Use)) +
  geom_jitter(width = 0.15, height = 0.15, aes(color = Taxon), size = 3, alpha = 0.5) + 
  geom_smooth(method = glm, se = F, method.args= list(family="binomial")) + labs(title = "Frugivory vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Frugivory (1 = Yes, 0 = No)") + 
  theme_minimal()

ggplot(tool_use_expanded, aes(x = Folivore, y = Tool_Use)) +
  geom_jitter(width = 0.15, height = 0.15, aes(color = Taxon), size = 3, alpha = 0.5) + 
  geom_smooth(method = glm, se = F, method.args= list(family="binomial")) +  labs(title = "Folivory vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Folivory (1 = Yes, 0 = No)") + theme_minimal()

ggplot(tool_use_expanded, aes(Dexterity_Index, Tool_Use)) +
  geom_point(aes(color = Taxon), size = 3, alpha = 0.5) + 
  geom_smooth(method = glm, se = F, 
              method.args = list(family="binomial")) + 
  labs(title = "Dexterity Index vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Dexterity Index") + 
  theme_minimal()

ggplot(tool_use_expanded, aes(Brain_Weight_grams, Tool_Use)) +
  geom_point(aes(color = Taxon), size = 3, alpha = 0.5) +
  geom_smooth(method = glm, se = F, 
              method.args= list(family="binomial"))  +
  labs(title = "Brain Weight vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Brain Weight (grams)") +
  scale_x_continuous(trans='log2') + 
  theme_minimal()

ggplot(tool_use_expanded, aes(Group_Size, Tool_Use)) + 
  geom_point(aes(color = Taxon), size = 3, alpha = 0.5) + geom_smooth(method = glm, se = F,                                                                 method.args= list(family="binomial")) + 
  labs(title = "Group Size vs. Tool Use",
       y = "Tool Use (1 = Yes, 0 = No)",
       x = "Average Group Size")  + 
  scale_x_continuous(trans='log2') + theme_minimal()
```
